<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>PrivPrompt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root{
        --bg: #ffffff;
        --fg: #111418;
        --muted:#6b7280;
        --card:#f6f7f9;
        --border:#e5e7eb;
        --accent:#2563eb;
        --accent-weak:#dbeafe;
        --danger:#ef4444;
        --ok:#16a34a;
        --shadow: 0 8px 24px rgba(0,0,0,.08);
      }
      @media (prefers-color-scheme: dark){
        :root{
          --bg:#0f1115;
          --fg:#e6e8eb;
          --muted:#9aa3af;
          --card:#171a21;
          --border:#252a33;
          --accent:#60a5fa;
          --accent-weak:#0b1a2f;
          --danger:#f87171;
          --ok:#34d399;
          --shadow: 0 10px 28px rgba(0,0,0,.35);
        }
      }
      *{box-sizing:border-box}
      html,body{margin:0;padding:0}
      body{
        font: 13px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color:var(--fg);
        background:var(--bg);
        min-width: 300px;
        max-width: 380px;
        padding: 14px;
      }

      .card{
        background:var(--card);
        border:1px solid var(--border);
        border-radius:12px;
        padding:12px;
        box-shadow:var(--shadow);
      }

      .header{
        display:flex;align-items:center;gap:10px;margin-bottom:10px;
      }
      .logo{
        width:20px;height:20px;display:inline-block;border-radius:6px;
        background: linear-gradient(135deg, var(--accent), #7c3aed);
      }
      .title{font-weight:700}
      .subtitle{color:var(--muted);font-size:12px}

      .seg{
        display:flex;gap:8px;background:var(--bg);border:1px solid var(--border);
        padding:4px;border-radius:10px; margin-top:8px;
      }
      .seg button{
        flex:1; border:0; background:transparent; padding:8px 10px; border-radius:8px;
        color:var(--fg); cursor:pointer; font-weight:600;
      }
      .seg button[aria-pressed="true"]{
        background:var(--accent-weak);
        color:var(--accent); 
      }

      .hint{margin-top:8px;color:var(--muted)}
      .row{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:12px}
      .status{
        display:flex;align-items:center;gap:8px;
        padding:8px 10px;border:1px solid var(--border);border-radius:8px;background:var(--bg);
        min-height:34px;flex:1;
      }
      .dot{width:8px;height:8px;border-radius:50%;background:var(--muted)}
      .dot.ok{background:var(--ok)}
      .dot.bad{background:var(--danger)}
      .actions{display:flex;gap:8px}
      .btn{
        appearance:none;border:1px solid var(--border);background:var(--bg);color:var(--fg);
        border-radius:8px;padding:8px 10px;cursor:pointer;font-weight:600;
      }
      .btn.primary{border-color:transparent;background:var(--accent);color:white}
      .small{font-size:12px;color:var(--muted);margin-top:10px}
      a { color: var(--accent); text-decoration: none; }
      a:hover { text-decoration: underline; }
    </style>
  </head>
  <body>
    <div class="card">
      <div class="header">
        <span class="logo" aria-hidden="true"></span>
        <div>
          <div class="title">PrivPrompt</div>
          <div class="subtitle">Privacy guard for ChatGPT requests</div>
        </div>
      </div>

      <div>
        <div class="subtitle" style="margin-bottom:4px;">Mode</div>
        <div class="seg" role="group" aria-label="Protection mode">
          <button id="m-warn"   data-mode="warn"   aria-pressed="false" title="Allow all; redact sensitive text">Warn</button>
          <button id="m-strict" data-mode="strict" aria-pressed="false" title="Block non-text uploads; redact text">Strict</button>
          <button id="m-block"  data-mode="block"  aria-pressed="false" title="Block all outbound requests">Block</button>
        </div>
        <div class="hint">Applies on <b>chatgpt.com</b> requests only.</div>
      </div>

      <div class="row">
        <div class="status" id="status">
          <span class="dot" id="dot"></span>
          <span id="statusText">Checking proxyâ€¦</span>
        </div>
        <div class="actions">
          <button class="btn" id="btnHealth" title="Ping proxy /healthz">Health</button>
          <button class="btn primary" id="btnSave" title="Save current mode">Save</button>
        </div>
      </div>

      <div class="small" id="extra">
        Tip: type an email in a prompt to see redaction in action (a small notice appears on the page).
      </div>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
